{
  "tools": [
    {
      "id": "add_mail_attachment",
      "target": "src.tools.mail_tools:add_mail_attachment",
      "description": "Add an attachment to an email message. Use when you have a message id and need to attach a small (<3 MB) file or reference. Get message_id from tools like list_messages or search_messages (then pick a message's id). You can provide either file_path (path to file - recommended) OR contentBytes (base64-encoded content).",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to attach to"
          },
          "name": {
            "type": "string",
            "description": "The name of the attachment (auto-filled from file_path if not provided)"
          },
          "odata_type": {
            "type": "string",
            "description": "The OData type (e.g., '#microsoft.graph.fileAttachment')"
          },
          "file_path": {
            "type": "string",
            "description": "Path to the file to attach (recommended - will be automatically encoded to base64). Example: 'C:\\Users\\name\\file.pdf' or './document.docx'"
          },
          "contentBytes": {
            "type": "string",
            "description": "Base64-encoded content of the file (optional if file_path is provided)"
          },
          "contentId": {
            "type": "string",
            "description": "Content ID for inline attachments"
          },
          "contentLocation": {
            "type": "string",
            "description": "Content location URL"
          },
          "contentType": {
            "type": "string",
            "description": "MIME type of the attachment (auto-detected from file_path if not provided)"
          },
          "isInline": {
            "type": "boolean",
            "description": "Whether the attachment is inline"
          },
          "item": {
            "type": "object",
            "description": "Item data for item attachments"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "odata_type"]
      }
    },
    {
      "id": "batch_move_messages",
      "target": "src.tools.mail_tools:batch_move_messages",
      "description": "Batch-move up to 20 Outlook messages to a destination folder in a single Microsoft Graph $batch call. Use when moving multiple messages to avoid per-message move API calls. Get message_ids from list_messages or search_messages (pick the 'id' field of each message). Get destination_id from list_mail_folders (use the folder 'id' or a well-known name like 'inbox', 'drafts', 'deleteditems', 'sentitems').",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_ids": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of message IDs to move (max 20). Get these from list_messages or search_messages."
          },
          "destination_id": {
            "type": "string",
            "description": "The destination folder ID or well-known name (e.g. 'inbox', 'drafts', 'deleteditems'). Get this from list_mail_folders."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_ids", "destination_id"]
      }
    },
    {
      "id": "batch_update_messages",
      "target": "src.tools.mail_tools:batch_update_messages",
      "description": "Batch-update up to 20 Outlook messages per call using Microsoft Graph JSON batching. Use when marking multiple messages read/unread or updating other properties to avoid per-message PATCH calls. Get message_id values from list_messages or search_messages (pick the 'id' field of each message you want to update). Each object in the 'updates' array must include a 'message_id' and at least one property to change (e.g. isRead, categories, importance, flag, inferenceClassification).",
      "input_schema": {
        "type": "object",
        "properties": {
          "updates": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "message_id": {
                  "type": "string",
                  "description": "The ID of the message to update. Get from list_messages or search_messages."
                },
                "isRead": {
                  "type": "boolean",
                  "description": "Mark message as read (true) or unread (false)"
                },
                "categories": {
                  "type": "array",
                  "items": {"type": "string"},
                  "description": "List of categories to assign. Get available categories from get_master_categories."
                },
                "importance": {
                  "type": "string",
                  "enum": ["low", "normal", "high"],
                  "description": "Importance level"
                },
                "flag": {
                  "type": "object",
                  "description": "Flag object, e.g. {\"flagStatus\": \"flagged\"}"
                },
                "inferenceClassification": {
                  "type": "string",
                  "enum": ["focused", "other"],
                  "description": "Move to Focused or Other inbox"
                }
              },
              "required": ["message_id"]
            },
            "description": "List of update objects (max 20). Each must have 'message_id' plus at least one property to update."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["updates"]
      }
    },
    {
      "id": "create_attachment_upload_session",
      "target": "src.tools.attachment_tools:create_attachment_upload_session",
      "description": "Create an upload session for large (>3 MB) message attachments. Use when you need to upload attachments in chunks instead of a single request. Get message_id from list_messages (folder='drafts'), search_messages, or create_draft (the returned 'id'). The message must be a draft.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the draft message. Get from list_messages (folder='drafts'), search_messages, or create_draft."
          },
          "attachmentItem": {
            "type": "object",
            "properties": {
              "attachmentType": {
                "type": "string",
                "description": "Type of attachment (e.g. 'file')"
              },
              "name": {
                "type": "string",
                "description": "File name (e.g. 'large-report.pdf')"
              },
              "size": {
                "type": "integer",
                "description": "Total file size in bytes"
              }
            },
            "required": ["attachmentType", "name", "size"],
            "description": "Attachment metadata. Example: {\"attachmentType\": \"file\", \"name\": \"report.pdf\", \"size\": 5242880}"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "attachmentItem"]
      }
    },
    {
      "id": "create_calendar",
      "target": "src.tools.calendar_tools:create_calendar",
      "description": "Create a new calendar in the signed-in user's mailbox. Use when organizing events into a separate calendar.",
      "input_schema": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the calendar"
          },
          "color": {
            "type": "string",
            "enum": ["auto", "lightBlue", "lightGreen", "lightOrange", "lightGray", "lightYellow", "lightTeal", "lightPink", "lightBrown", "lightPurple", "lightRed"],
            "description": "Calendar color preset"
          },
          "hexColor": {
            "type": "string",
            "description": "Hex color code for the calendar"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["name"]
      }
    },
    {
      "id": "create_contact_folder",
      "target": "src.tools.contact_tools:create_contact_folder",
      "description": "Create a new contact folder in the user's mailbox. Use when needing to organize contacts into custom folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string",
            "description": "The display name of the contact folder"
          },
          "parentFolderId": {
            "type": "string",
            "description": "Parent folder ID to create subfolder"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["displayName"]
      }
    },
    {
      "id": "create_email_rule",
      "target": "src.tools.rule_tools:create_email_rule",
      "description": "Create email rule filter with conditions and actions.",
      "input_schema": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string",
            "description": "The display name of the rule"
          },
          "conditions": {
            "type": "object",
            "description": "The conditions that trigger the rule"
          },
          "actions": {
            "type": "object",
            "description": "The actions to perform when conditions are met"
          },
          "isEnabled": {
            "type": "boolean",
            "description": "Whether the rule is enabled"
          },
          "sequence": {
            "type": "integer",
            "description": "The order of the rule in the rule list"
          }
        },
        "required": ["displayName", "conditions", "actions"]
      }
    },
    {
      "id": "create_mail_folder",
      "target": "src.tools.folder_tools:create_mail_folder",
      "description": "Create a new mail folder or subfolder (child folder). To create a top-level folder, just provide displayName. To create a subfolder, also provide parent_folder_id. Get parent_folder_id from list_mail_folders (pick the 'id' field of the parent folder) or use a well-known name like 'inbox', 'drafts', 'sentitems', 'deleteditems'.",
      "input_schema": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string",
            "description": "The display name of the mail folder"
          },
          "parent_folder_id": {
            "type": "string",
            "description": "Optional parent folder ID to create a subfolder. Get from list_mail_folders or list_child_mail_folders. If omitted, creates a top-level folder."
          },
          "isHidden": {
            "type": "boolean",
            "description": "Whether the folder is hidden"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["displayName"]
      }
    },
    {
      "id": "create_master_category",
      "target": "src.tools.category_tools:create_master_category",
      "description": "Create a new category in the user's master category list. Use after selecting a unique display name.",
      "input_schema": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string",
            "description": "The display name of the category"
          },
          "color": {
            "type": "string",
            "enum": ["preset0", "preset1", "preset2", "preset3", "preset4", "preset5", "preset6", "preset7", "preset8", "preset9", "preset10", "preset11", "preset12", "preset13", "preset14", "preset15", "preset16", "preset17", "preset18", "preset19", "preset20", "preset21", "preset22", "preset23", "preset24"],
            "description": "Color preset (preset0 through preset24)"
          }
        },
        "required": ["displayName"]
      }
    },
    {
      "id": "decline_event",
      "target": "src.tools.calendar_tools:decline_event",
      "description": "Decline an invitation to a calendar event. Use when the user wants to decline a meeting or event invitation. The API returns 202 Accepted with no content on success. Get event_id from list_events or get_event (pick the 'id' field of the event you want to decline).",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event to decline. Get from list_events or get_event."
          },
          "comment": {
            "type": "string",
            "description": "Optional message to include with the decline response"
          },
          "sendResponse": {
            "type": "boolean",
            "description": "Whether to send a response to the organizer (default true)"
          },
          "proposedNewTime": {
            "type": "object",
            "description": "Optional proposed new time. Example: {\"start\": {\"dateTime\": \"2026-02-15T10:00:00\", \"timeZone\": \"UTC\"}, \"end\": {\"dateTime\": \"2026-02-15T11:00:00\", \"timeZone\": \"UTC\"}}"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id"]
      }
    },
    {
      "id": "delete_email_rule",
      "target": "src.tools.rule_tools:delete_email_rule",
      "description": "Delete an email rule from the user's inbox. Get ruleId from list_email_rules (pick the 'id' field of the rule you want to delete).",
      "input_schema": {
        "type": "object",
        "properties": {
          "ruleId": {
            "type": "string",
            "description": "The ID of the email rule to delete. Get from list_email_rules (use the 'id' field)."
          }
        },
        "required": ["ruleId"]
      }
    },
    {
      "id": "delete_master_category",
      "target": "src.tools.category_tools:delete_master_category",
      "description": "Delete a category from the user's master category list. Use when removing unused or obsolete categories from the mailbox. Get category_id from get_master_categories (pick the 'id' field of the category you want to delete).",
      "input_schema": {
        "type": "object",
        "properties": {
          "category_id": {
            "type": "string",
            "description": "The ID of the category to delete. Get from get_master_categories (use the 'id' field)."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["category_id"]
      }
    },
    {
      "id": "delete_message",
      "target": "src.tools.mail_tools:delete_message",
      "description": "Permanently delete an Outlook email message by its message_id. Use when removing unwanted messages, cleaning up drafts, or performing mailbox maintenance. Get message_id from list_messages or search_messages (pick the 'id' field of the message you want to delete).",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to delete. Get from list_messages or search_messages."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "delete_mail_folder",
      "target": "src.tools.folder_tools:delete_mail_folder",
      "description": "Delete a mail folder from the user's mailbox. Use when you need to remove an existing mail folder. Get folder_id from list_mail_folders (use the id from the folder you want to delete).",
      "input_schema": {
        "type": "object",
        "properties": {
          "folder_id": {
            "type": "string",
            "description": "The ID of the mail folder to delete"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["folder_id"]
      }
    },
    {
      "id": "find_meeting_times",
      "target": "src.tools.calendar_tools:find_meeting_times",
      "description": "Suggests meeting times based on organizer and attendee availability, time constraints, and duration requirements. Use when you need to find optimal meeting slots across multiple participants' schedules. Get attendee email addresses from list_contacts or get_contact. Use get_supported_time_zones for valid timezone values.",
      "input_schema": {
        "type": "object",
        "properties": {
          "attendees": {
            "type": "array",
            "items": {"type": "object"},
            "description": "List of attendee objects. Each: {\"emailAddress\": {\"address\": \"email\", \"name\": \"Name\"}, \"type\": \"required\"}. Get emails from list_contacts."
          },
          "timeConstraint": {
            "type": "object",
            "description": "Time window: {\"activityDomain\": \"work\", \"timeSlots\": [{\"start\": {\"dateTime\": \"...\", \"timeZone\": \"...\"}, \"end\": {\"dateTime\": \"...\", \"timeZone\": \"...\"}}]}"
          },
          "locationConstraint": {
            "type": "object",
            "description": "Location constraint object"
          },
          "meetingDuration": {
            "type": "string",
            "description": "Duration in ISO 8601 format (e.g. 'PT1H' for 1 hour, 'PT30M' for 30 min)"
          },
          "maxCandidates": {
            "type": "integer",
            "description": "Max number of suggestions to return"
          },
          "isOrganizerOptional": {
            "type": "boolean",
            "description": "Whether the organizer is optional (default false)"
          },
          "returnSuggestionReasons": {
            "type": "boolean",
            "description": "Whether to return reasons for each suggestion"
          },
          "minimumAttendeePercentage": {
            "type": "number",
            "description": "Minimum % of attendees that must be available (0-100)"
          },
          "prefer_timezone": {
            "type": "string",
            "description": "Preferred timezone. Get from get_supported_time_zones."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "forward_message",
      "target": "src.tools.mail_tools:forward_message",
      "description": "Forward an existing email message to new recipients. Use when you need to send an existing email to someone else. Get message_id from list_messages or search_messages (pick the 'id' field of the message you want to forward).",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to forward. Get from list_messages or search_messages."
          },
          "to_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of recipient email addresses to forward to"
          },
          "comment": {
            "type": "string",
            "description": "Optional message to include with the forwarded email"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "to_recipients"]
      }
    },
    {
      "id": "get_calendar_view",
      "target": "src.tools.calendar_tools:get_calendar_view",
      "description": "Get events ACTIVE during a time window (includes multi-day events). Use for 'what's on my calendar today/this week' or availability checks. Returns events overlapping the time range. For keyword search or filters by category, use list_events instead. Get calendar_id from list_calendars if you want a specific calendar's view. Use get_supported_time_zones for valid timezone values.",
      "input_schema": {
        "type": "object",
        "properties": {
          "start_datetime": {
            "type": "string",
            "description": "Start of time range (ISO 8601, e.g. '2026-02-12T00:00:00')"
          },
          "end_datetime": {
            "type": "string",
            "description": "End of time range (ISO 8601, e.g. '2026-02-12T23:59:59')"
          },
          "calendar_id": {
            "type": "string",
            "description": "Optional calendar ID. Get from list_calendars. Defaults to primary calendar."
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "top": {
            "type": "integer",
            "description": "Max number of events to return"
          },
          "timezone": {
            "type": "string",
            "description": "Timezone for the response. Get from get_supported_time_zones."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["start_datetime", "end_datetime"]
      }
    },
    {
      "id": "download_attachment",
      "target": "src.tools.attachment_tools:download_outlook_attachment",
      "description": "Download a specific file attachment from an email message. The attachment must contain 'contentBytes' (binary data) and not be a link or embedded item. Get message_id from list_messages or search_messages, and attachment_id from list_attachments.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message containing the attachment"
          },
          "attachment_id": {
            "type": "string",
            "description": "The ID of the attachment to download"
          },
          "file_name": {
            "type": "string",
            "description": "The name to save the file as"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "attachment_id", "file_name"]
      }
    },
    {
      "id": "get_mailbox_settings",
      "target": "src.tools.settings_tools:get_mailbox_settings",
      "description": "Retrieve mailbox settings. Use when you need to view settings such as automatic replies, time zone, and working hours for the signed-in or specified user.",
      "input_schema": {
        "type": "object",
        "properties": {
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "expand": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to expand"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_mail_delta",
      "target": "src.tools.settings_tools:get_mail_delta",
      "description": "Retrieve incremental changes (delta) of messages in a mailbox. Use when syncing mailbox updates since last checkpoint. Get folder_id from list_mail_folders if you want delta for a specific folder.",
      "input_schema": {
        "type": "object",
        "properties": {
          "folder_id": {
            "type": "string",
            "description": "Folder ID to get delta for specific folder"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "expand": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to expand"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "search": {
            "type": "string",
            "description": "Search query"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "count": {
            "type": "boolean",
            "description": "Whether to include count of items"
          },
          "delta_token": {
            "type": "string",
            "description": "Token from previous delta call for incremental sync"
          },
          "skip_token": {
            "type": "string",
            "description": "Token for pagination"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_mail_tips",
      "target": "src.tools.settings_tools:get_mail_tips",
      "description": "Retrieve mail tips such as automatic replies and mailbox full status. Use when you need to check recipient status before sending mail.",
      "input_schema": {
        "type": "object",
        "properties": {
          "EmailAddresses": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of email addresses to get mail tips for"
          },
          "MailTipsOptions": {
            "type": "string",
            "description": "Comma-separated mail tip options: automaticReplies, customMailTip, deliveryRestriction, externalMemberCount, mailboxFullStatus, maxMessageSize, moderationStatus, recipientScope, recipientSuggestions, totalMemberCount"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["EmailAddresses", "MailTipsOptions"]
      }
    },
    {
      "id": "get_master_categories",
      "target": "src.tools.category_tools:get_master_categories",
      "description": "Retrieve the user's master category list. Use when you need to get all categories defined for the user.",
      "input_schema": {
        "type": "object",
        "properties": {
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_supported_languages",
      "target": "src.tools.settings_tools:get_supported_languages",
      "description": "Retrieve supported languages in the user's mailbox. Use when you need to display or select from available mailbox languages.",
      "input_schema": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_supported_time_zones",
      "target": "src.tools.settings_tools:get_supported_time_zones",
      "description": "Retrieve supported time zones in the user's mailbox. Use when you need a list of time zones to display or choose from for event scheduling.",
      "input_schema": {
        "type": "object",
        "properties": {
          "timeZoneStandard": {
            "type": "string",
            "enum": ["Windows", "Iana"],
            "description": "Time zone standard (Windows or Iana)"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_child_mail_folders",
      "target": "src.tools.list_tools:list_child_mail_folders",
      "description": "List subfolders (childFolders) under a specified Outlook mail folder. Use when navigating nested folder hierarchies or checking if a folder has subfolders. Get parent_folder_id from list_mail_folders (pick the 'id' field of the parent folder) or use a well-known name like 'inbox', 'drafts', 'sentitems', 'deleteditems'.",
      "input_schema": {
        "type": "object",
        "properties": {
          "parent_folder_id": {
            "type": "string",
            "description": "The ID of the parent mail folder. Get from list_mail_folders (use the 'id' field) or a well-known name like 'inbox'."
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "include_hidden_folders": {
            "type": "boolean",
            "description": "Whether to include hidden folders"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "top": {
            "type": "integer",
            "description": "Max number of folders to return"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["parent_folder_id"]
      }
    },
    {
      "id": "list_email_rules",
      "target": "src.tools.rule_tools:list_email_rules",
      "description": "List all email rules from the user's inbox. Use when you need to see existing rules before creating, updating, or deleting them. The returned rules include their 'id' field which you can pass to delete_email_rule to remove a specific rule.",
      "input_schema": {
        "type": "object",
        "properties": {
          "top": {
            "type": "integer",
            "description": "Max number of rules to return"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_mail_folder_messages",
      "target": "src.tools.list_tools:list_mail_folder_messages",
      "description": "List messages from a specific mail folder including subfolders. Use when you need to retrieve messages from a particular folder or subfolder by its ID or well-known name. Get mail_folder_id from list_mail_folders (pick the 'id' field of the folder) or list_child_mail_folders for subfolders. You can also use well-known names like 'inbox', 'drafts', 'sentitems', 'deleteditems'.",
      "input_schema": {
        "type": "object",
        "properties": {
          "mail_folder_id": {
            "type": "string",
            "description": "The ID of the mail folder. Get from list_mail_folders or list_child_mail_folders (use the 'id' field), or a well-known name like 'inbox'."
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "string",
            "description": "Property to order by (e.g. 'receivedDateTime desc')"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "top": {
            "type": "integer",
            "description": "Max number of messages to return"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["mail_folder_id"]
      }
    },
    {
      "id": "list_users",
      "target": "src.tools.user_tools:list_users",
      "description": "List users in Microsoft Entra ID. Use when you need to retrieve a paginated list of users, optionally filtering or selecting specific properties. For the signed-in user only, use get_profile instead. Note: requires User.Read.All or User.ReadBasic.All permission for listing other users.",
      "input_schema": {
        "type": "object",
        "properties": {
          "filter": {
            "type": "string",
            "description": "OData filter expression (e.g. \"startswith(displayName, 'John')\" or \"department eq 'Engineering'\")"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select (e.g. 'displayName', 'mail', 'userPrincipalName', 'id', 'jobTitle')"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "top": {
            "type": "integer",
            "description": "Max number of users to return"
          }
        },
        "required": []
      }
    },
    {
      "id": "permanent_delete_message",
      "target": "src.tools.mail_tools:permanent_delete_message",
      "description": "Permanently delete an Outlook message by moving it to the Purges folder in the dumpster. Unlike standard delete_message, this action makes the message UNRECOVERABLE by the user. IMPORTANT: This is NOT the same as delete_message â€” permanentDelete is irreversible and not available in US Government L4, L5 (DOD), or China (21Vianet) deployments. Get message_id from list_messages or search_messages (pick the 'id' field). Optionally provide mail_folder_id from list_mail_folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to permanently delete. Get from list_messages or search_messages."
          },
          "mail_folder_id": {
            "type": "string",
            "description": "Optional folder ID containing the message. Get from list_mail_folders."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "pin_message",
      "target": "src.tools.teams_tools:pin_message",
      "description": "Pin a message in a Teams chat. Use when you want to mark an important message for quick access. Get chat_id from list_chats (pick the 'id' field). Get message_url by constructing it: https://graph.microsoft.com/v1.0/chats/{chat_id}/messages/{message_id}. Get message_id from list_chat_messages (pick the 'id' field of the message you want to pin).",
      "input_schema": {
        "type": "object",
        "properties": {
          "chat_id": {
            "type": "string",
            "description": "The ID of the chat. Get from list_chats."
          },
          "message_url": {
            "type": "string",
            "description": "The full URL of the message to pin. Format: https://graph.microsoft.com/v1.0/chats/{chat_id}/messages/{message_id}. Get message_id from list_chat_messages."
          }
        },
        "required": ["chat_id", "message_url"]
      }
    },
    {
      "id": "query_emails",
      "target": "src.tools.mail_tools:query_emails",
      "description": "Query Outlook emails within a SINGLE folder using OData filters. Build precise server-side filters for dates, read status, importance, subjects, attachments, and conversations. Best for structured queries on message metadata within a specific folder. Returns up to 100 messages per request with pagination support. Searches SINGLE folder only (inbox, sentitems, etc.) - NOT across all folders. For cross-folder search use search_messages. Get folder name or ID from list_mail_folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "folder": {
            "type": "string",
            "description": "Folder name or ID. Get from list_mail_folders. Well-known: 'inbox', 'drafts', 'sentitems', 'deleteditems', 'junkemail', 'archive'. Defaults to inbox."
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression (e.g. \"isRead eq false\", \"importance eq 'high'\", \"hasAttachments eq true\", \"receivedDateTime ge 2026-02-01T00:00:00Z\", \"contains(subject, 'meeting')\")"
          },
          "orderby": {
            "type": "string",
            "description": "Property to order by (e.g. 'receivedDateTime desc')"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip (pagination)"
          },
          "top": {
            "type": "integer",
            "description": "Max number of messages to return (max 100)"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "send_draft",
      "target": "src.tools.mail_tools:send_draft",
      "description": "Send an existing draft message. Use after creating a draft (via create_draft) when you want to deliver it to recipients immediately. Get message_id from create_draft (the returned 'id'), or from list_messages with folder='drafts' (pick the 'id' field of the draft you want to send).",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the draft message to send. Get from create_draft or list_messages (folder='drafts')."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "update_email_rule",
      "target": "src.tools.rule_tools:update_email_rule",
      "description": "Update an existing email rule. Provide only the fields you want to change. Get ruleId from list_email_rules (pick the 'id' field of the rule you want to update).",
      "input_schema": {
        "type": "object",
        "properties": {
          "ruleId": {
            "type": "string",
            "description": "The ID of the email rule to update. Get from list_email_rules (use the 'id' field)."
          },
          "displayName": {
            "type": "string",
            "description": "New display name for the rule"
          },
          "conditions": {
            "type": "object",
            "description": "New conditions (replaces existing). Same format as create_email_rule conditions."
          },
          "actions": {
            "type": "object",
            "description": "New actions (replaces existing). Same format as create_email_rule actions."
          },
          "isEnabled": {
            "type": "boolean",
            "description": "Enable or disable the rule"
          },
          "sequence": {
            "type": "integer",
            "description": "New order of the rule in the list (must be >= 1)"
          }
        },
        "required": ["ruleId"]
      }
    },
    {
      "id": "list_chats",
      "target": "src.tools.teams_tools:list_chats",
      "description": "List Teams chats for the signed-in user. Use when you need chat IDs and topics to select a chat for further actions like list_chat_messages.",
      "input_schema": {
        "type": "object",
        "properties": {
          "top": {
            "type": "integer",
            "description": "Max number of chats to return"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "string",
            "description": "Property to order by"
          },
          "expand": {
            "type": "string",
            "description": "Property to expand (e.g. 'members', 'lastMessagePreview')"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_chat_messages",
      "target": "src.tools.teams_tools:list_chat_messages",
      "description": "List messages in a Teams chat. Use when you need message IDs to select a specific message for further actions. Get chat_id from list_chats (pick the 'id' field of the chat you want to read messages from).",
      "input_schema": {
        "type": "object",
        "properties": {
          "chat_id": {
            "type": "string",
            "description": "The ID of the chat. Get from list_chats."
          },
          "top": {
            "type": "integer",
            "description": "Max number of messages to return"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "string",
            "description": "Property to order by"
          }
        },
        "required": ["chat_id"]
      }
    },
    {
      "id": "list_calendars",
      "target": "src.tools.list_tools:list_calendars",
      "description": "List calendars in the signed-in user's mailbox. Use when you need to retrieve calendars with optional OData queries. Use this first when you need a calendar id for other calendar-related operations.",
      "input_schema": {
        "type": "object",
        "properties": {
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_event_attachments",
      "target": "src.tools.list_tools:list_event_attachments",
      "description": "List attachments for a specific calendar event. Use when you have an event ID and need to view its attachments. Get event_id from list_events or get_event.",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id"]
      }
    },
    {
      "id": "list_attachments",
      "target": "src.tools.list_tools:list_outlook_attachments",
      "description": "List metadata (like name, size, and type, but not contentBytes) for all attachments of a specified email message. Get message_id from list_messages or search_messages.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "list_reminders",
      "target": "src.tools.list_tools:list_reminders",
      "description": "Retrieve reminders for events occurring within a specified time range. Use when you need to see upcoming reminders between two datetimes. Use list_events or get_event if you need full event details.",
      "input_schema": {
        "type": "object",
        "properties": {
          "startDateTime": {
            "type": "string",
            "description": "Start of the time range (ISO 8601 format, e.g., 2026-02-04T00:00:00Z)"
          },
          "endDateTime": {
            "type": "string",
            "description": "End of the time range (ISO 8601 format, e.g., 2026-02-11T00:00:00Z)"
          },
          "userId": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["startDateTime", "endDateTime"]
      }
    },
    {
      "id": "add_event_attachment",
      "target": "src.tools.calendar_tools:add_event_attachment",
      "description": "Add an attachment to a specific calendar event. Use when you need to attach a file or nested item to an existing event. Get event_id from list_events or get_event. For file attachments, you can provide: file_path (auto-encodes file), text_content (auto-encodes text), or contentBytes (pre-encoded Base64).",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event"
          },
          "name": {
            "type": "string",
            "description": "The name of the attachment (e.g., 'document.pdf', 'notes.txt')"
          },
          "odata_type": {
            "type": "string",
            "enum": ["#microsoft.graph.fileAttachment", "#microsoft.graph.itemAttachment"],
            "description": "The type of attachment"
          },
          "file_path": {
            "type": "string",
            "description": "Path to a file to attach - will be automatically read and Base64 encoded"
          },
          "text_content": {
            "type": "string",
            "description": "Plain text content to attach - will be automatically Base64 encoded"
          },
          "contentBytes": {
            "type": "string",
            "description": "Base64-encoded content (use only if you already have Base64 data)"
          },
          "item": {
            "type": "object",
            "description": "Item data (for item attachments)"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id", "name", "odata_type"]
      }
    },
    {
      "id": "create_event",
      "target": "src.tools.calendar_tools:create_event",
      "description": "Create a new calendar event, ensuring start datetime is chronologically before end datetime. Use list_calendars first if you need to inspect calendars before creating events.",
      "input_schema": {
        "type": "object",
        "properties": {
          "subject": {
            "type": "string",
            "description": "The subject of the event"
          },
          "body": {
            "type": "string",
            "description": "The body content of the event"
          },
          "start_datetime": {
            "type": "string",
            "description": "Start date/time (ISO 8601 format, e.g., 2026-02-05T10:00:00)"
          },
          "end_datetime": {
            "type": "string",
            "description": "End date/time (ISO 8601 format, e.g., 2026-02-05T11:00:00)"
          },
          "time_zone": {
            "type": "string",
            "description": "Time zone (e.g., Pacific Standard Time, UTC)"
          },
          "location": {
            "type": "string",
            "description": "Location of the event"
          },
          "attendees_info": {
            "type": "array",
            "items": {"type": "object"},
            "description": "List of attendee info [{emailAddress: {address, name}, type}]"
          },
          "categories": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of categories"
          },
          "is_html": {
            "type": "boolean",
            "description": "Whether body is HTML"
          },
          "is_online_meeting": {
            "type": "boolean",
            "description": "Whether it's an online meeting"
          },
          "online_meeting_provider": {
            "type": "string",
            "description": "Online meeting provider (teamsForBusiness, skypeForBusiness, skypeForConsumer)"
          },
          "show_as": {
            "type": "string",
            "description": "Show as status (free, tentative, busy, oof, workingElsewhere)"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["subject", "body", "start_datetime", "end_datetime", "time_zone"]
      }
    },
    {
      "id": "create_contact",
      "target": "src.tools.contact_tools:create_contact",
      "description": "Create a new contact in the user's contacts folder. Use get_contact_folders to get folder_id if you want to store the contact in a specific folder. Use list_contacts if you want to inspect existing contacts first.",
      "input_schema": {
        "type": "object",
        "properties": {
          "givenName": {
            "type": "string",
            "description": "First name"
          },
          "surname": {
            "type": "string",
            "description": "Last name"
          },
          "displayName": {
            "type": "string",
            "description": "Display name"
          },
          "emailAddresses": {
            "type": "array",
            "items": {"type": "object"},
            "description": "List of email addresses [{address, name}]"
          },
          "businessPhones": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of business phone numbers"
          },
          "mobilePhone": {
            "type": "string",
            "description": "Mobile phone number"
          },
          "homePhone": {
            "type": "string",
            "description": "Home phone number"
          },
          "companyName": {
            "type": "string",
            "description": "Company name"
          },
          "department": {
            "type": "string",
            "description": "Department"
          },
          "jobTitle": {
            "type": "string",
            "description": "Job title"
          },
          "officeLocation": {
            "type": "string",
            "description": "Office location"
          },
          "birthday": {
            "type": "string",
            "description": "Birthday (ISO 8601 date, e.g., 1990-01-15)"
          },
          "categories": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of categories"
          },
          "notes": {
            "type": "string",
            "description": "Notes about the contact"
          },
          "folderId": {
            "type": "string",
            "description": "Contact folder ID to store the contact in a specific folder. Get folder_id from get_contact_folders tool. If not provided, contact is created in the default contacts folder."
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "create_draft",
      "target": "src.tools.mail_tools:create_draft",
      "description": "Create an email draft with subject, body, recipients, and an optional attachment. Supports creating drafts as part of existing conversation threads. Use list_messages to later locate this draft by subject, recipients, or isDraft=true.",
      "input_schema": {
        "type": "object",
        "properties": {
          "subject": {
            "type": "string",
            "description": "The subject of the email"
          },
          "body": {
            "type": "string",
            "description": "The body content of the email"
          },
          "to_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of recipient email addresses"
          },
          "cc_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of CC email addresses"
          },
          "bcc_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of BCC email addresses"
          },
          "is_html": {
            "type": "boolean",
            "description": "Whether body is HTML"
          },
          "conversation_id": {
            "type": "string",
            "description": "Conversation ID for threading"
          },
          "attachment": {
            "type": "object",
            "description": "Attachment object {name, contentType, contentBytes}"
          }
        },
        "required": ["subject", "body", "to_recipients"]
      }
    },
    {
      "id": "create_draft_reply",
      "target": "src.tools.mail_tools:create_draft_reply",
      "description": "Create a draft reply to an existing message, optionally including a comment and cc/bcc recipients. Get the original message_id from list_messages or search_messages.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to reply to"
          },
          "comment": {
            "type": "string",
            "description": "Optional comment/reply text"
          },
          "cc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of CC email addresses"
          },
          "bcc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of BCC email addresses"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "delete_contact",
      "target": "src.tools.contact_tools:delete_contact",
      "description": "Permanently delete an existing contact. Get contact_id from list_contacts or get_contact.",
      "input_schema": {
        "type": "object",
        "properties": {
          "contact_id": {
            "type": "string",
            "description": "The ID of the contact to delete"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["contact_id"]
      }
    },
    {
      "id": "delete_event",
      "target": "src.tools.calendar_tools:delete_event",
      "description": "Delete an existing calendar event, with an option to send cancellation notifications to attendees. Get event_id from list_events or get_event.",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event to delete"
          },
          "send_notifications": {
            "type": "boolean",
            "description": "Whether to send cancellation notifications to attendees"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id"]
      }
    },
    {
      "id": "get_contact",
      "target": "src.tools.contact_tools:get_contact",
      "description": "Retrieve a specific contact by its contact ID. Get contact_id from list_contacts or get_contact_folders + contacts in a folder.",
      "input_schema": {
        "type": "object",
        "properties": {
          "contact_id": {
            "type": "string",
            "description": "The ID of the contact to retrieve"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["contact_id"]
      }
    },
    {
      "id": "get_contact_folders",
      "target": "src.tools.contact_tools:get_contact_folders",
      "description": "Retrieves a list of contact folders in the signed-in user's mailbox. Use after authentication when you need to browse or select among contact folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "expand": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to expand"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_event",
      "target": "src.tools.calendar_tools:get_event",
      "description": "Retrieve the full details of a specific calendar event by its ID. Get event_id from list_events or from reminders that reference events.",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event to retrieve"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id"]
      }
    },
    {
      "id": "get_message",
      "target": "src.tools.mail_tools:get_message",
      "description": "Retrieve a specific email message by its ID from the user's mailbox. Use the 'select' parameter to include specific fields like 'internetMessageHeaders'. Get message_id from list_messages or search_messages.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to retrieve"
          },
          "select": {
            "type": "string",
            "description": "Comma-separated list of properties to select (e.g., 'subject,body,internetMessageHeaders')"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "get_profile",
      "target": "src.tools.profile_tools:get_profile",
      "description": "Retrieves the Microsoft Outlook profile for a specified user.",
      "input_schema": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "get_schedule",
      "target": "src.tools.calendar_tools:get_schedule",
      "description": "Retrieves free/busy schedule information for specified email addresses within a defined time window.",
      "input_schema": {
        "type": "object",
        "properties": {
          "Schedules": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of email addresses to get schedule for"
          },
          "StartTime": {
            "type": "object",
            "description": "Start time object {dateTime: '2026-02-04T09:00:00', timeZone: 'Pacific Standard Time'}"
          },
          "EndTime": {
            "type": "object",
            "description": "End time object {dateTime: '2026-02-04T18:00:00', timeZone: 'Pacific Standard Time'}"
          },
          "availabilityViewInterval": {
            "type": "string",
            "description": "Interval in minutes (e.g., '30')"
          }
        },
        "required": ["Schedules", "StartTime", "EndTime"]
      }
    },
    {
      "id": "list_contacts",
      "target": "src.tools.list_tools:list_contacts",
      "description": "Retrieves a user's Microsoft Outlook contacts, from the default or a specified contact folder.",
      "input_schema": {
        "type": "object",
        "properties": {
          "contact_folder_id": {
            "type": "string",
            "description": "Contact folder ID to retrieve contacts from a specific folder"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_events",
      "target": "src.tools.list_tools:list_events",
      "description": "Retrieves events from a user's Outlook calendar via Microsoft Graph API, supporting pagination, filtering, property selection, sorting, and timezone specification.",
      "input_schema": {
        "type": "object",
        "properties": {
          "expand_recurring_events": {
            "type": "boolean",
            "description": "If true, uses calendarView to expand recurring events"
          },
          "filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "timezone": {
            "type": "string",
            "description": "Timezone for the response (e.g., 'Pacific Standard Time')"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_mail_folders",
      "target": "src.tools.list_tools:list_mail_folders",
      "description": "Lists a user's top-level mail folders. Use when you need folders like Inbox, Drafts, Sent Items. Set include_hidden_folders=true to include hidden folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "include_hidden_folders": {
            "type": "boolean",
            "description": "Whether to include hidden folders"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "list_messages",
      "target": "src.tools.list_tools:list_messages",
      "description": "Retrieves a list of email messages from a specified mail folder in an Outlook mailbox, with options for filtering (including by conversationId to get all messages in a thread), pagination, and sorting. Ensure 'user_id' and 'folder' are valid, and all date/time strings are in ISO 8601 format.",
      "input_schema": {
        "type": "object",
        "properties": {
          "folder": {
            "type": "string",
            "description": "Mail folder ID or well-known name (inbox, drafts, sentitems, deleteditems)"
          },
          "categories": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of categories to filter by"
          },
          "conversationId": {
            "type": "string",
            "description": "Conversation ID to get all messages in a thread"
          },
          "from_address": {
            "type": "string",
            "description": "Sender email address to filter by"
          },
          "has_attachments": {
            "type": "boolean",
            "description": "Filter for messages with attachments"
          },
          "importance": {
            "type": "string",
            "enum": ["low", "normal", "high"],
            "description": "Importance filter"
          },
          "is_read": {
            "type": "boolean",
            "description": "Filter for read/unread messages"
          },
          "orderby": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to order by"
          },
          "received_date_time_ge": {
            "type": "string",
            "description": "Filter for receivedDateTime >= value (ISO 8601)"
          },
          "received_date_time_gt": {
            "type": "string",
            "description": "Filter for receivedDateTime > value (ISO 8601)"
          },
          "received_date_time_le": {
            "type": "string",
            "description": "Filter for receivedDateTime <= value (ISO 8601)"
          },
          "received_date_time_lt": {
            "type": "string",
            "description": "Filter for receivedDateTime < value (ISO 8601)"
          },
          "select": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of properties to select"
          },
          "sent_date_time_gt": {
            "type": "string",
            "description": "Filter for sentDateTime > value (ISO 8601)"
          },
          "sent_date_time_lt": {
            "type": "string",
            "description": "Filter for sentDateTime < value (ISO 8601)"
          },
          "skip": {
            "type": "integer",
            "description": "Number of items to skip"
          },
          "subject": {
            "type": "string",
            "description": "Exact subject to filter by"
          },
          "subject_contains": {
            "type": "string",
            "description": "Substring to search in subject"
          },
          "subject_endswith": {
            "type": "string",
            "description": "Suffix to search in subject"
          },
          "subject_startswith": {
            "type": "string",
            "description": "Prefix to search in subject"
          },
          "top": {
            "type": "integer",
            "description": "Number of items to return"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": []
      }
    },
    {
      "id": "move_message",
      "target": "src.tools.mail_tools:move_message",
      "description": "Move a message to another folder within the specified user's mailbox. This creates a new copy of the message in the destination folder and removes the original message. Get message_id from list_messages or search_messages, and destination_id from list_mail_folders.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to move"
          },
          "destination_id": {
            "type": "string",
            "description": "The ID of the destination folder (or well-known name like 'inbox', 'drafts', 'deleteditems')"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "destination_id"]
      }
    },
    {
      "id": "reply_email",
      "target": "src.tools.mail_tools:reply_email",
      "description": "Send a plain text reply to an email message, identified by message_id, allowing optional CC and BCC recipients. Get message_id from list_messages or search_messages (must be a received message, not a draft).",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to reply to"
          },
          "comment": {
            "type": "string",
            "description": "The reply text/comment to send"
          },
          "cc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of CC email addresses"
          },
          "bcc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of BCC email addresses"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id", "comment"]
      }
    },
    {
      "id": "search_messages",
      "target": "src.tools.mail_tools:search_messages",
      "description": "Search messages in the mailbox using filters for sender, subject, attachments, and pagination. Use this to find message_id values for tools like get_message, reply_email, add_mail_attachment, move_message, and download_attachment.",
      "input_schema": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "The search query string"
          },
          "fromEmail": {
            "type": "string",
            "description": "Sender email address to filter by. Leave empty or omit to not filter by sender."
          },
          "subject": {
            "type": "string",
            "description": "Subject to search for. Leave empty or omit to not filter by subject."
          },
          "hasAttachments": {
            "type": "boolean",
            "description": "Filter for messages with attachments"
          },
          "from_index": {
            "type": "integer",
            "description": "Starting index for pagination"
          },
          "size": {
            "type": "integer",
            "description": "Number of results to return"
          },
          "enable_top_results": {
            "type": "boolean",
            "description": "Enable top results sorting"
          }
        },
        "required": ["query"]
      }
    },
    {
      "id": "send_email",
      "target": "src.tools.mail_tools:send_email",
      "description": "Send an email with subject, body, recipients, and an optional attachment via Microsoft Graph API. Attachments require a non-empty file with valid name and mimetype. Use get_profile if you need the current user's details before sending.",
      "input_schema": {
        "type": "object",
        "properties": {
          "subject": {
            "type": "string",
            "description": "The subject of the email"
          },
          "body": {
            "type": "string",
            "description": "The body content of the email"
          },
          "to_email": {
            "type": "string",
            "description": "The primary recipient email address"
          },
          "to_name": {
            "type": "string",
            "description": "Name of the primary recipient"
          },
          "cc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of CC email addresses"
          },
          "bcc_emails": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of BCC email addresses"
          },
          "is_html": {
            "type": "boolean",
            "description": "Whether body is HTML"
          },
          "attachment": {
            "type": "object",
            "description": "Attachment object {name, contentType, contentBytes}"
          },
          "save_to_sent_items": {
            "type": "boolean",
            "description": "Whether to save the email to Sent Items (default: true)"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["subject", "body", "to_email"]
      }
    },
    {
      "id": "update_calendar_event",
      "target": "src.tools.calendar_tools:update_calendar_event",
      "description": "Update specified fields of an existing calendar event. Get event_id from list_events or get_event.",
      "input_schema": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "description": "The ID of the event to update"
          },
          "subject": {
            "type": "string",
            "description": "Subject of the event"
          },
          "body": {
            "type": "object",
            "description": "Body object with contentType and content"
          },
          "start_datetime": {
            "type": "string",
            "description": "Start date/time (ISO 8601 format, e.g., 2026-02-05T10:00:00)"
          },
          "end_datetime": {
            "type": "string",
            "description": "End date/time (ISO 8601 format, e.g., 2026-02-05T11:00:00)"
          },
          "time_zone": {
            "type": "string",
            "description": "Time zone (e.g., Pacific Standard Time, UTC)"
          },
          "location": {
            "type": "object",
            "description": "Location object with displayName"
          },
          "attendees": {
            "type": "array",
            "items": {"type": "object"},
            "description": "List of attendee info [{emailAddress: {address, name}, type}]"
          },
          "categories": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of categories"
          },
          "show_as": {
            "type": "string",
            "enum": ["free", "tentative", "busy", "oof", "workingElsewhere"],
            "description": "Show as status"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["event_id"]
      }
    },
    {
      "id": "update_contact",
      "target": "src.tools.contact_tools:update_contact",
      "description": "Update an existing contact, identified by contact_id for the specified user_id, requiring at least one other field to be modified. Get contact_id from list_contacts or get_contact.",
      "input_schema": {
        "type": "object",
        "properties": {
          "contact_id": {
            "type": "string",
            "description": "The ID of the contact to update"
          },
          "givenName": {
            "type": "string",
            "description": "First name"
          },
          "surname": {
            "type": "string",
            "description": "Last name"
          },
          "displayName": {
            "type": "string",
            "description": "Display name"
          },
          "emailAddresses": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "address": {
                  "type": "string",
                  "description": "Email address"
                },
                "name": {
                  "type": "string",
                  "description": "Display name for the email address"
                }
              },
              "required": ["address"]
            },
            "description": "List of email addresses [{address, name}]"
          },
          "businessPhones": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of business phone numbers"
          },
          "mobilePhone": {
            "type": "string",
            "description": "Mobile phone number"
          },
          "homePhones": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of home phone numbers"
          },
          "companyName": {
            "type": "string",
            "description": "Company name"
          },
          "department": {
            "type": "string",
            "description": "Department"
          },
          "jobTitle": {
            "type": "string",
            "description": "Job title"
          },
          "officeLocation": {
            "type": "string",
            "description": "Office location"
          },
          "birthday": {
            "type": "string",
            "description": "Birthday (ISO 8601 date, e.g., 1990-01-15)"
          },
          "categories": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of categories"
          },
          "notes": {
            "type": "string",
            "description": "Notes about the contact"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["contact_id"]
      }
    },
    {
      "id": "update_email",
      "target": "src.tools.mail_tools:update_email",
      "description": "Update specified properties of an existing email message. message_id must identify a valid message within the specified user_id's mailbox, and it must be a draft. Get draft message_id from list_messages (filter by folder='drafts' and is_read/isDraft as needed) or from create_draft.",
      "input_schema": {
        "type": "object",
        "properties": {
          "message_id": {
            "type": "string",
            "description": "The ID of the message to update"
          },
          "subject": {
            "type": "string",
            "description": "Subject of the email"
          },
          "body": {
            "type": "object",
            "description": "Body object with contentType and content"
          },
          "to_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of TO recipient email addresses"
          },
          "cc_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of CC recipient email addresses"
          },
          "bcc_recipients": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of BCC recipient email addresses"
          },
          "importance": {
            "type": "string",
            "enum": ["low", "normal", "high"],
            "description": "Importance level"
          },
          "user_id": {
            "type": "string",
            "description": "User ID (defaults to 'me')"
          }
        },
        "required": ["message_id"]
      }
    },
    {
      "id": "update_mailbox_settings",
      "target": "src.tools.settings_tools:update_mailbox_settings",
      "description": "Tool to update mailbox settings for the signed-in user. Use when you need to configure automatic replies, default time zone, language, or working hours. Example: schedule automatic replies for vacation.",
      "input_schema": {
        "type": "object",
        "properties": {
          "automaticRepliesSetting": {
            "type": "object",
            "description": "Automatic replies setting object with status, externalAudience, scheduledStartDateTime, scheduledEndDateTime, internalReplyMessage, externalReplyMessage"
          },
          "language": {
            "type": "object",
            "description": "Language object with locale and displayName"
          },
          "timeZone": {
            "type": "string",
            "description": "Time zone string (e.g., 'Pacific Standard Time')"
          },
          "workingHours": {
            "type": "object",
            "description": "Working hours object with daysOfWeek, startTime, endTime, timeZone"
          }
        },
        "required": []
      }
    }
  ]
}

